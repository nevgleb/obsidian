Простая машина на веб

# Этап разведки

В целом все ничего новго, [[Nmap]] наше все, стандарт, два открытых порта, один на [[SSH]] другой на веб.

Сайт имеет только одну функциональную страницу, на которой есть возможность отправить информацию о книги:
- картинку в виде файла  или ссылку на url
- дополнительная информация: автор, название, и т.п

Сходу я смогу определить три возможных вектора для атаки:
- [[SQL-инъекций]] на всех полях
- [[SSRF]] на поле ввода url
- [[Уязвимости при загрузке файлов]] на поле загрузки файлов

>[!Забавный факт]
>Вектор с загрузкой картинок долго не мог заметить из-за того, что не видел кнопку для предосмотра :)

SQLi быстро прогнал через [[sqlmap]], в результате пусто.

Загрузка файлов в основном не имела смысла, т.к не использовались исполняемые файлы по типу php. Да и в целом на данный момент используемые технологии были тайной.

## SSRF и ошибки

Тут не смог дотянуть из-за того, что использовал ссылку на картинку которая находилась в Интернете.

Как я понял, htb в целях безопасности, не позволяет ходить в Интернет, а только по локальной сети  к котороый мы подключаемся по  впн.

Попробовать в слепую просканить открытые порты, в целом можно было, но с точки зрения реальной цели - это было бы плохо, т.к появилось бы много лишнего трафика.

Ошикба:
- ***не воспользовался [[Burp Collaborator]]***

Узнал одну фишку, до которой в целом мог бы и сам додуматься:
- Можно использовать netcat для прослушивания порта, т.к ip относиться к внутренй сети машины это бы сработало, но в реальной сетуации нужен был бы белый ip

# Этап эксплуатации

В целом при определнии наличии [[SSRF]] мои мысли по поводу векторы были верными, начать сканить внутрение порты, но из-за того что я уже поймал сполер я особо не сканил.
После сканирования перебором портов, находим 5000 порт, который возвращает приложение и его api, там есть апи для получения кредов, получаем их потом на ssh. Бум, флаг прользователя присуствует.

# Этап пост эксплуатации

## Горизонтальное передвижение
В целом этам оказался достаточно простым, что я отметил, так это имя пользователя dev, в passwd был также и prod, также в домашней директории  было папка с приложением, в котором была дириктория .git, тут очевидно, что через git show стоит поискать старые креды, бум находим креды к dev.

## Вертикальное передвижение
 Ну тут произошел казус,  флаг root сразу был, поэтому просто прочел его, но сначала проверил  sudo -l, там была команда, которая выполнялась от рута, но я не предал этому значению, а просто сдал флаг.

Но в целом, флаг простой, вектор уже был найден, если бы не было флага, то копал бы в сторону этой команды, там был питоновский скрипт, котороый имел изместную [[CVE]]
Эксплуатируем ее по PoC и получаем рута, в целом ничего сложного.

Разве только не забыть посмотрить **pip3 list**

# Выводы

В целом, все хорошо, ошибки были помечены выше, что заметил для себя:
- начинает появляться осознаность действей, понимание возможных векторов
- начинает появляться определенная методика:
	- заметил, что после сканирования веб приложения, начинаю сразу искать директории, при этом пока скинруется пробегаюсь по визуальной части приоложения
	- разделяю на функциональные блоги и прикидываю возможные уязвимости
	- также стараюсь опредлеить технологии
	- после начинаю проверять через прокси свои догадки

Пока как-то так
